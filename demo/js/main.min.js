"use strict";Vue.component("o-transfer",{name:"oTransfer",template:'\n  <div class="o-transfer">\n    <div class="transfer-panel">\n      <div class="tab-head">\n        <div class="tab-item" :class="{\'select\': tabID === 0}" @click="tabID = 0" v-if="display.depts">\n          <span :data-num="SDepts.length">部门</span>\n        </div>\n        <div class="tab-item" :class="{\'select\': tabID === 1}" @click="tabID = 1" v-if="display.dutys">\n          <span :data-num="SDutys.length">职务</span>\n        </div>\n        <div class="tab-item" :class="{\'select\': tabID === 2}" @click="tabID = 2" v-if="display.groups">\n          <span>群组</span>\n        </div>\n        <div class="tab-item" :class="{\'select\': tabID === 3}" @click="tabID = 3" v-if="display.users">\n          <span :data-num="SUsers.length">用户</span>\n        </div>\n      </div>\n      <div class="tab-bar" :class="\'seq\' + TrueTabID"></div>\n      <div class="tab-content">\n        <div class="body-wrapper" :class="\'seq\' + tabID">\n          \x3c!-- 部门列表 --\x3e\n          <div class="body">\n            <div class="content">\n              <div class="item" v-for="i in depts" :class="{\'select\': i.select}" v-text="i.name" @click="i.select = !i.select" :key="\'deptsl\' + i.id"></div>\n            </div>\n          </div>\n          \x3c!-- 职务-部门 列表 --\x3e\n          <div class="body">\n            <div class="content dutys">\n              <div class="item" v-for="i in dutys" :key="\'dutysl\' + i.id">\n                <p v-text="i.name" @click="toggleDutys(i)" class="cup" title="全选 / 取消"></p>\n                <p class="min-tag"><span v-for="d in i.depts" :key="\'dutysltag\' + d.id" v-text="d.name" @click="d.select = !d.select" :class="{\'select\': d.select}"></span></p>\n              </div>\n            </div>\n          </div>\n          \x3c!-- 用户组列表 --\x3e\n          <div class="body">\n            <div class="content">\n              <div class="item" v-for="i in groups" :class="{\'select\': i.select}" v-text="i.name + \' ( \' + i.users.length + \' )\'" @click="i.select = !i.select" :key="\'groupsl\' + i.id"></div>\n            </div>\n          </div>\n          \x3c!-- 用户列表 --\x3e\n          <div class="body">\n            <div class="content">\n              <div class="item" v-for="i in Users" :class="{\'select\': i.select}" @click="toggleUser(i)" :key="\'usersl\' + i.id">\n                <span v-text="i.name"></span>\n                <i class="el-icon-star-on" v-if="i.follow" @click.stop="follow(i, false)" title="取消常用联系人"></i>\n                <i class="el-icon-star-off" v-else @click.stop="follow(i, true)" title="添加为常用联系人"></i>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <slot><slot/>\n    <div class="transfer-panel">\n      \x3c!-- 搜索框（添加额外人员） --\x3e\n      <div class="tab-head">\n        <div class="search-select">\n          <input type="text" class="search" v-model="key" :class="{\'error\': key && !user, \'success\': key && user}" @keyup.enter="addUser">\n          <div class="search-content">\n            <div class="item" v-for="i in list" @click="selectUser(i)">\n              <span v-text="i.name" class="name"></span>\n              <span v-text="i.dept"></span>\n            </div>\n          </div>\n        </div>\n        <button type="button" :class="{\'disable\': !user}" @click="addUser">添加</button>\n      </div>\n      <div class="tab-content">\n        <div class="content del">\n          \x3c!-- 选择的部门 --\x3e\n          <div class="item dept" v-for="i in SDepts" @click="i.select = false" :key="\'deptsr\' + i.id">\n            <span v-text="i.name"></span>\n            <i class="el-icon-delete"></i>\n          </div>\n          \x3c!-- 选择的职务 --\x3e\n          <div class="item duty" v-for="i in SDutys" :key="\'dutysr\' + i.id">\n            <p v-text="i.name"></p>\n            <p class="min-tag">\n              <template v-for="d in i.depts"><span class="select" :key="d.id" v-if="d.select" v-text="d.name" @click="d.select = false"></span></template>\n            </p>\n          </div>\n          \x3c!-- 选择的用户 --\x3e\n          <div class="item user" v-for="i in SUsers" @click="cancelUser(i.id)" :key="\'usersr\' + i.id">\n            <span v-text="i.name"></span>\n            <i class="el-icon-delete"></i>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n  ',props:["data","value"],data:function(){return{tabID:-1,selectValue:null,key:"",depts:[],dutys:[],groups:[],users:[],usersID:[],user:null,list:[],display:{depts:!0,dutys:!0,groups:!0,users:!0}}},watch:{data:"update",key:"search",dutys:{handler:"updateValue",deep:!0}},methods:{selectUser:function(s){this.user=s,this.list=[]},search:function(){var e=this;this.$emit("search",this.key,function(s){s.status&&s.users?(1===s.users.length&&(e.user=s.users[0]),1<=s.users.length&&(e.list=s.users)):e.user=null})},follow:function(e,t){var i=this;this.$emit("follow",{id:e.id,name:e.name,follow:t},function(s){s.status&&i.users.some(function(s){return s.id==e.id&&(s.follow=t,!0)})})},addUser:function(){var e=this;this.user&&(this.user.follow=!1,this.users.every(function(s){return s.id!=e.user.id})&&this.users.push(this.user),this.usersID.push(this.user.id),this.key="")},update:function(){var t=this;if(this.data.display)for(var s in this.display)!1===this.data.display[s]?this.display[s]=!1:this.display[s]=!0;["depts","dutys","groups","users"].some(function(s,e){return!!t.display[s]&&(t.tabID=e,!0)}),this.depts=this.data.depts.map(function(s){return{select:!1,id:s.id,name:s.name}}),this.dutys=this.data.dutys.map(function(s){return{id:s.id,name:s.name,depts:s.depts.map(function(s){return{id:s.id,name:s.name,tid:s.tid,select:!1}})}}),this.groups=this.data.groups.map(function(s){return{id:s.id,name:s.name,select:!1,users:s.users.map(function(s){return s.id})}}),this.users=this.data.users.map(function(s){return{id:s.id,name:s.name,follow:!0}}),this.defaultSelect()},defaultSelect:function(){var t,s=this;this.value&&(this.value.depts&&(t={},this.value.depts.forEach(function(s){t[s.id]=!0}),this.depts.forEach(function(s){t[s.id]&&(s.select=!0)})),this.value.dutys&&(t={},this.value.dutys.forEach(function(e){e.depts.forEach(function(s){t[e.id+"-"+s.id]=!0})}),this.dutys.forEach(function(e){e.depts.forEach(function(s){t[e.id+"-"+s.id]&&(s.select=!0)})})),this.value.users&&this.value.users.forEach(function(e){s.users.every(function(s){return s.id!=e.id})&&s.users.push({id:e.id,name:e.name,follow:!1}),s.usersID.push(e.id)}))},toggleDutys:function(s){var e=s.depts.every(function(s){return s.select});s.depts.forEach(function(s){s.select=!e})},cancelUser:function(e){var t=this;this.groups.forEach(function(s){s.select&&s.users.some(function(s){return s==e})&&(s.select=!1,t.usersID=t.usersID.concat(s.users.filter(function(s){return s!=e})))}),this.usersID=this.usersID.filter(function(s){return s!=e})},toggleUser:function(s){s.select?this.cancelUser(s.id):this.usersID.push(s.id)},updateValue:function(){var s=this;clearTimeout(this._st),this._st=setTimeout(function(){s.selectValue={depts:s.SDepts.map(function(s){return{id:s.id,name:s.name}}),dutys:s.SDutys.map(function(s){return{id:s.id,name:s.name,depts:s.depts.filter(function(s){return s.select}).map(function(s){return{id:s.id,name:s.name,tid:s.tid}})}}),users:s.SUsers.map(function(s){return{id:s.id,name:s.name}})},s.$emit("change")},242)}},computed:{TrueTabID:function(){for(var s=this.tabID,e=["depts","dutys","groups","users"],t=0;t<=this.tabID;t++)!1===this.display[e[t]]&&s--;return s},SDepts:function(){return this.updateValue(),this.depts.filter(function(s){return s.select})},SDutys:function(){return this.updateValue(),this.dutys.filter(function(s){return s.depts.some(function(s){return s.select})})},SUsers:function(){this.updateValue();var t=this.usersID;return this.groups.forEach(function(s){s.select&&(t=t.concat(s.users))}),this.users.filter(function(e){return t.some(function(s){return s==e.id})})},Users:function(){var t=this.usersID;return this.groups.forEach(function(s){s.select&&(t=t.concat(s.users))}),this.users.map(function(e){return{id:e.id,name:e.name,follow:e.follow,select:t.some(function(s){return s==e.id})}})},Value:function(){return this.selectValue}},mounted:function(){this.update()}});
//# sourceMappingURL=main.min.js.map
