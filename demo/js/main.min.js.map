{"version":3,"sources":["demo/script/main.js"],"names":["Vue","component","name","template","props","data","status","methods","select","this","result","getStatus","check","flag","_this","child","forEach","i","_this2","every","computed","hasChild","length","Level","level","style","paddingLeft","isShow","loop","item","some","tabID","selectValue","key","depts","dutys","groups","users","usersID","user","list","display","watch","handler","deep","selectUser","search","_this3","$emit","follow","_this4","id","u","addUser","_this5","push","update","_this6","index","map","pid","d","tid","defaultSelect","tem","_this7","value","toggleDutys","s","cancelUser","_this8","concat","filter","toggleUser","updateValue","_this9","clearTimeout","_st","setTimeout","SDepts","SDutys","SUsers","Depts","t","TrueTabID","Users","Value","BW","width","size","BH","height","panelStyle","bodyStyle","mounted"],"mappings":"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","file":"main.min.js","sourcesContent":["Vue.component('xc-tree', {\n  name: 'tree',\n  template: `\n  <div class=\"xc-tree\" v-if=\"isShow\">\n    <div class=\"item\" @click=\"select(data)\" :class=\"{'select': data.select}\" :style=\"style\">\n      <span class=\"arrow\" :class=\"{'open': status}\" @click.stop=\"status = !status\">\n        <svg v-if=\"hasChild\" class=\"icon\" viewBox=\"0 0 1024 1024\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" width=\"10\" height=\"10\">\n          <path d=\"M802.68856889 453.16323555l-381.64837605-381.64837603a83.2203173 83.2203173 0 0 0-142.05708173 58.83676446L278.98311111 893.64837602a83.2203173 83.2203173 0 0 0 142.05708173 58.83676446l381.64837605-381.64837603a83.2203173 83.2203173 0 0 0 0-117.6735289z\"></path>\n        </svg>\n      </span>\n      <span v-text=\"data.name\" class=\"txt\"></span>\n    </div>\n    <xc-tree v-show=\"status\" :data=\"i\" :level=\"Level + 1\" v-for=\"i in data.child\" :key=\"i.id\" :result=\"result\"></xc-tree>\n  </div>\n  `,\n  props: ['data', 'level', 'result'],\n  data() {\n    return {\n      status: false\n    };\n  },\n  methods: {\n    select(data) {\n      if(this.result) {\n        if(data.select) data.select = false;\n        return;\n      }\n      if(data.select) {\n        if(this.getStatus(data)) this.check(data, false);\n        else data.select = false;\n      }else {\n        this.check(data, true);\n      }\n    },\n    check(data, flag) {\n      data.select = flag;\n      if(data.child) {\n        data.child.forEach(i => {\n          this.check(i, flag);\n        });\n      }\n    },\n    getStatus(data) {\n      if(!data.select) return false;\n      if(data.child) {\n        return data.child.every(i => this.getStatus(i));\n      }\n      return true;\n    }\n  },\n  computed: {\n    hasChild() {\n      // console.log(this.data);\n      if(this.data && this.data.child && this.data.child.length) return true;\n      return false;\n    },\n    Level() {\n      return this.level || 0;\n    },\n    style() {\n      return {\n        paddingLeft: this.Level * 10 + 5 + 'px'\n      };\n    },\n    isShow() {\n      function loop(item) {\n        if(item.select) return true;\n        if(item.child) {\n          return item.child.some(i => loop(i));\n        }\n        return false;\n      }\n      if(this.result) return loop(this.data);\n      return true;\n    }\n  }\n});\nVue.component('o-transfer', {\n  name: 'oTransfer',\n  template: `\n  <div class=\"o-transfer\" :class=\"{'disabled': disabled}\">\n    <div class=\"transfer-panel\" :style=\"panelStyle\">\n      <div class=\"tab-head\">\n        <div class=\"tab-item\" :class=\"{'select': tabID === 0}\" @click=\"tabID = 0\" v-if=\"display.depts\">\n          <span :data-num=\"SDepts.length\">部门</span>\n        </div>\n        <div class=\"tab-item\" :class=\"{'select': tabID === 1}\" @click=\"tabID = 1\" v-if=\"display.dutys\">\n          <span :data-num=\"SDutys.length\">职务</span>\n        </div>\n        <div class=\"tab-item\" :class=\"{'select': tabID === 2}\" @click=\"tabID = 2\" v-if=\"display.groups\">\n          <span>群组</span>\n        </div>\n        <div class=\"tab-item\" :class=\"{'select': tabID === 3}\" @click=\"tabID = 3\" v-if=\"display.users\">\n          <span :data-num=\"SUsers.length\">用户</span>\n        </div>\n      </div>\n      <div class=\"tab-bar\" :class=\"'seq' + TrueTabID\"></div>\n      <div class=\"tab-content\" :style=\"{'height': BH + 'px'}\">\n        <div class=\"body-wrapper\" :class=\"'seq' + tabID\">\n          <!-- 部门列表 -->\n          <div class=\"body\">\n            <div class=\"content\" :style=\"bodyStyle\">\n              <xc-tree :data=\"i\" v-for=\"i in Depts\" :key=\"i.id\"></xc-tree>\n              <!-- <div class=\"item\" v-for=\"i in depts\" :class=\"{'select': i.select}\" v-text=\"i.name\" @click=\"i.select = !i.select\" :key=\"'deptsl' + i.id\"></div> -->\n            </div>\n          </div>\n          <!-- 职务-部门 列表 -->\n          <div class=\"body\">\n            <div class=\"content dutys\" :style=\"bodyStyle\">\n              <div class=\"item\" v-for=\"i in dutys\" :key=\"'dutysl' + i.id\" :class=\"{'select': i.select}\">\n                <p v-text=\"i.name\" @click=\"toggleDutys(i)\" class=\"cup\" title=\"全选 / 取消\"></p>\n                <p class=\"min-tag\" v-if=\"false\"><span v-for=\"d in i.depts\" :key=\"'dutysltag' + d.id\" v-text=\"d.name\" @click=\"d.select = !d.select\" :class=\"{'select': d.select}\"></span></p>\n              </div>\n            </div>\n          </div>\n          <!-- 用户组列表 -->\n          <div class=\"body\">\n            <div class=\"content\" :style=\"bodyStyle\">\n              <div class=\"item\" v-for=\"i in groups\" :class=\"{'select': i.select}\" v-text=\"i.name + ' ( ' + i.users.length + ' )'\" @click=\"i.select = !i.select\" :key=\"'groupsl' + i.id\"></div>\n            </div>\n          </div>\n          <!-- 用户列表 -->\n          <div class=\"body\">\n            <div class=\"content\" :style=\"bodyStyle\">\n              <div class=\"item\" v-for=\"i in Users\" :class=\"{'select': i.select}\" @click=\"toggleUser(i)\" :key=\"'usersl' + i.id\">\n                <span v-text=\"i.name\"></span>\n                <i class=\"el-icon-star-on\" v-if=\"i.follow\" @click.stop=\"follow(i, false)\" title=\"取消常用联系人\"></i>\n                <i class=\"el-icon-star-off\" v-else @click.stop=\"follow(i, true)\" title=\"添加为常用联系人\"></i>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <slot></slot>\n    <div class=\"transfer-panel\" :style=\"panelStyle\">\n      <!-- 搜索框（添加额外人员） -->\n      <div class=\"tab-head\" :class=\"{'disabled': disableadd}\">\n        <div class=\"search-select\">\n          <input type=\"text\" :style=\"{width: BW - 55 + 'px'}\" :disabled=\"disableadd\" class=\"search\" v-model=\"key\" :class=\"{'error': key && !user, 'success': key && user}\" @keyup.enter=\"addUser\">\n          <div class=\"search-content\">\n            <div class=\"item\" v-for=\"i in list\" :key=\"i.id\" @click=\"selectUser(i)\">\n              <span v-text=\"i.name\" class=\"name\"></span>\n              <span v-text=\"i.dept\"></span>\n            </div>\n          </div>\n        </div>\n        <button type=\"button\" :class=\"{'disable': !user}\" @click=\"addUser\">添加</button>\n      </div>\n      <div class=\"tab-content\" :style=\"{'height': BH + 'px'}\">\n        <div class=\"content del\" :style=\"bodyStyle\">\n          <!-- 选择的部门 -->\n          <xc-tree :data=\"i\" v-for=\"i in Depts\" :key=\"i.id\" :result=\"true\"></xc-tree>\n          <!-- <div class=\"item dept\" v-for=\"i in SDepts\" @click=\"i.select = false\" :key=\"'deptsr' + i.id\">\n            <span v-text=\"i.name\"></span>\n            <svg class=\"del\" viewBox=\"0 0 1024 1024\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" width=\"14\" height=\"14\"><path d=\"M641.536 189.781333V64c0-35.157333-23.893333-64-56.490667-64H448.597333c-32.426667 0-66.048 28.842667-66.048 64v125.781333H179.2c7.850667 0-51.2 12.885333-51.2 66.218667 0 35.157333 26.624 64 59.050667 64h649.898666C869.376 320 896 291.157333 896 256c0-53.333333-59.050667-66.218667-59.050667-66.218667h-195.413333zM448 192V128c0-44.544 28.416-64 64-64 36.437333 0 64 19.626667 64 64v64h-128zM320 1024h384c70.4 0 128-57.6 128-128v-512H192v512c0 70.4 57.6 128 128 128z m323.754667-483.584c0-15.616 11.946667-28.416 26.368-28.416 14.506667 0 26.368 12.8 26.368 28.416v341.333333c0 15.701333-11.946667 28.501333-26.453334 28.501334-14.421333 0-26.282667-12.8-26.282666-28.501334v-341.333333z m-158.122667 0c0-15.616 11.946667-28.416 26.368-28.416 14.506667 0 26.368 12.8 26.368 28.416v341.333333c0 15.701333-11.946667 28.501333-26.368 28.501334-14.506667 0-26.368-12.8-26.368-28.501334v-341.333333z m-158.122667 0c0-15.616 11.946667-28.416 26.453334-28.416 14.421333 0 26.282667 12.8 26.282666 28.416v341.333333c0 15.701333-11.946667 28.501333-26.368 28.501334-14.506667 0-26.368-12.8-26.368-28.501334v-341.333333z\" p-id=\"2699\"></path></svg>\n          </div> -->\n          <!-- 选择的职务 -->\n          <div class=\"item duty\" v-for=\"i in SDutys\" :key=\"'dutysr' + i.id\" @click=\"toggleDutys(i)\">\n            <p v-text=\"i.name\"></p>\n            <!-- <p class=\"min-tag\">\n              <template v-for=\"d in i.depts\"><span class=\"select\" :key=\"d.id\" v-if=\"d.select\" v-text=\"d.name\" @click=\"d.select = false\"></span></template>\n            </p> -->\n            <svg class=\"del\" viewBox=\"0 0 1024 1024\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" width=\"14\" height=\"14\"><path d=\"M641.536 189.781333V64c0-35.157333-23.893333-64-56.490667-64H448.597333c-32.426667 0-66.048 28.842667-66.048 64v125.781333H179.2c7.850667 0-51.2 12.885333-51.2 66.218667 0 35.157333 26.624 64 59.050667 64h649.898666C869.376 320 896 291.157333 896 256c0-53.333333-59.050667-66.218667-59.050667-66.218667h-195.413333zM448 192V128c0-44.544 28.416-64 64-64 36.437333 0 64 19.626667 64 64v64h-128zM320 1024h384c70.4 0 128-57.6 128-128v-512H192v512c0 70.4 57.6 128 128 128z m323.754667-483.584c0-15.616 11.946667-28.416 26.368-28.416 14.506667 0 26.368 12.8 26.368 28.416v341.333333c0 15.701333-11.946667 28.501333-26.453334 28.501334-14.421333 0-26.282667-12.8-26.282666-28.501334v-341.333333z m-158.122667 0c0-15.616 11.946667-28.416 26.368-28.416 14.506667 0 26.368 12.8 26.368 28.416v341.333333c0 15.701333-11.946667 28.501333-26.368 28.501334-14.506667 0-26.368-12.8-26.368-28.501334v-341.333333z m-158.122667 0c0-15.616 11.946667-28.416 26.453334-28.416 14.421333 0 26.282667 12.8 26.282666 28.416v341.333333c0 15.701333-11.946667 28.501333-26.368 28.501334-14.506667 0-26.368-12.8-26.368-28.501334v-341.333333z\" p-id=\"2699\"></path></svg>\n          </div>\n          <!-- 选择的用户 -->\n          <div class=\"item user\" v-for=\"i in SUsers\" @click=\"cancelUser(i.id)\" :key=\"'usersr' + i.id\">\n            <span v-text=\"i.name\"></span>\n            <svg class=\"del\" viewBox=\"0 0 1024 1024\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" width=\"14\" height=\"14\"><path d=\"M641.536 189.781333V64c0-35.157333-23.893333-64-56.490667-64H448.597333c-32.426667 0-66.048 28.842667-66.048 64v125.781333H179.2c7.850667 0-51.2 12.885333-51.2 66.218667 0 35.157333 26.624 64 59.050667 64h649.898666C869.376 320 896 291.157333 896 256c0-53.333333-59.050667-66.218667-59.050667-66.218667h-195.413333zM448 192V128c0-44.544 28.416-64 64-64 36.437333 0 64 19.626667 64 64v64h-128zM320 1024h384c70.4 0 128-57.6 128-128v-512H192v512c0 70.4 57.6 128 128 128z m323.754667-483.584c0-15.616 11.946667-28.416 26.368-28.416 14.506667 0 26.368 12.8 26.368 28.416v341.333333c0 15.701333-11.946667 28.501333-26.453334 28.501334-14.421333 0-26.282667-12.8-26.282666-28.501334v-341.333333z m-158.122667 0c0-15.616 11.946667-28.416 26.368-28.416 14.506667 0 26.368 12.8 26.368 28.416v341.333333c0 15.701333-11.946667 28.501333-26.368 28.501334-14.506667 0-26.368-12.8-26.368-28.501334v-341.333333z m-158.122667 0c0-15.616 11.946667-28.416 26.453334-28.416 14.421333 0 26.282667 12.8 26.282666 28.416v341.333333c0 15.701333-11.946667 28.501333-26.368 28.501334-14.506667 0-26.368-12.8-26.368-28.501334v-341.333333z\" p-id=\"2699\"></path></svg>\n            <!-- <i class=\"el-icon-delete\"></i> -->\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n  `,\n  props: ['data', 'value', 'disabled', 'disableadd', 'size'],\n  data() {\n    return {\n      tabID: -1,\n      selectValue: null,\n      key: '',\n      depts: [],\n      dutys: [],\n      groups: [],\n      users: [],\n      usersID: [],\n      user: null,\n      list: [],\n      display: {\n        depts: true,\n        dutys: true,\n        groups: true,\n        users: true\n      }\n    };\n  },\n  watch: {\n    data: 'update',\n    key: 'search',\n    dutys: {\n      handler: 'updateValue',\n      deep: true\n    }\n  },\n  methods: {\n    selectUser(i) {\n      this.user = i;\n      this.list = [];\n    },\n    search() {\n      this.$emit('search', this.key, data => {\n        if(data.status && data.users) {\n          if(data.users.length === 1) this.user = data.users[0];\n          if(data.users.length >= 1) this.list = data.users;\n        }else this.user = null;\n      });\n    },\n    follow(i, status) {\n      this.$emit('follow', {id: i.id, name: i.name, follow: status}, data => {\n        if(data.status) this.users.some(u => {\n          if(u.id === i.id) {\n            u.follow = status;\n            return true;\n          }\n          return false;\n        });\n      });\n    },\n    addUser() {\n      if(this.user) {\n        this.user.follow = false;\n        if(this.users.every(i => i.id !== this.user.id)) this.users.push(this.user);\n        this.usersID.push(this.user.id);\n        this.key = '';\n      }\n    },\n    update() {\n      if(this.data.display) {\n        for(var i in this.display) {\n          if(this.data.display[i] === false) this.display[i] = false;\n          else this.display[i] = true;\n        }\n      }\n      const map = ['depts', 'dutys', 'groups', 'users'];\n      map.some((i, index) => {\n        if(this.display[i]) {\n          this.tabID = index;\n          return true;\n        }\n        return false;\n      });\n      this.depts = this.data.depts.map(i => ({\n        select: false,\n        id: i.id,\n        pid: i.pid,\n        name: i.name,\n        child: []\n      }));\n      this.dutys = this.data.dutys.map(i => ({\n        id: i.id,\n        name: i.name,\n        select: false,\n        depts: i.depts.map(d => ({\n          id: d.id,\n          name: d.name,\n          tid: d.tid,\n          select: false\n        }))\n      }));\n      this.groups = this.data.groups.map(i => ({\n        id: i.id,\n        name: i.name,\n        select: false,\n        users: i.users.map(u => u.id)\n      }));\n      this.users = this.data.users.map(i => ({id: i.id, name: i.name, follow: true}));\n      this.defaultSelect();\n    },\n    defaultSelect() {\n      var tem;\n      if(this.value) {\n        if(this.value.depts) {\n          tem = {};\n          this.value.depts.forEach(i => {\n            tem[i.id] = true;\n          });\n          this.depts.forEach(i => {\n            if(tem[i.id]) i.select = true;\n          });\n        }\n        if(this.value.dutys) {\n          tem = {};\n          this.value.dutys.forEach(d => {\n            d.depts.forEach(i => {\n              tem[d.id + '-' + i.id] = true;\n            });\n          });\n          this.dutys.forEach(d => {\n            d.depts.forEach(i => {\n              if(tem[d.id + '-' + i.id]) {\n                i.select = true;\n                d.select = true;\n              }\n            });\n          });\n        }\n        if(this.value.users) {\n          this.value.users.forEach(u => {\n            if(this.users.every(i => i.id !== u.id)) this.users.push({id: u.id, name: u.name, follow: false});\n            this.usersID.push(u.id);\n          });\n        }\n      }\n    },\n    toggleDutys(i) {\n      var s = i.depts.every(d => d.select);\n      i.depts.forEach(d => {d.select = !s;});\n      i.select = !s;\n    },\n    cancelUser(id) {\n      this.groups.forEach(i => {\n        if(i.select && i.users.some(u => u === id)) {\n          i.select = false;\n          this.usersID = this.usersID.concat(i.users.filter(u => u !== id));\n        }\n      });\n      this.usersID = this.usersID.filter(i => i !== id);\n    },\n    toggleUser(i) {\n      if(i.select) this.cancelUser(i.id);\n      else this.usersID.push(i.id);\n    },\n    updateValue() {\n      clearTimeout(this._st);\n      this._st = setTimeout(() => {\n        this.selectValue = {\n          depts: this.SDepts.map(i => ({id: i.id, name: i.name})),\n          dutys: this.SDutys.map(i => ({\n            id: i.id,\n            name: i.name,\n            depts: i.depts.filter(d => d.select).map(d => ({id: d.id, name: d.name, tid: d.tid}))\n          })),\n          users: this.SUsers.map(i => ({id: i.id, name: i.name}))\n        };\n        this.$emit('change');\n      }, 242);\n    }\n  },\n  computed: {\n    Depts() {\n      var depts = this.depts;\n      var tem = depts.filter(i => !i.pid);\n      function loop(t) {\n        t.child = depts.filter(i => t.id === i.pid);\n        t.child.forEach(i => {\n          loop(i);\n        });\n      }\n      tem.forEach(i => {\n        loop(i);\n      });\n      return tem;\n    },\n    TrueTabID() {\n      var t = this.tabID;\n      const map = ['depts', 'dutys', 'groups', 'users'];\n      for(var i = 0; i <= this.tabID; i++) {\n        if(this.display[map[i]] === false) t--;\n      }\n      return t;\n    },\n    SDepts() {\n      this.updateValue();\n      return this.depts.filter(i => i.select);\n    },\n    SDutys() {\n      this.updateValue();\n      return this.dutys.filter(i => i.depts.some(d => d.select));\n    },\n    SUsers() {\n      this.updateValue();\n      var t = this.usersID;\n      this.groups.forEach(i => {\n        i.select && (t = t.concat(i.users));\n      });\n      return this.users.filter(i => t.some(u => u === i.id));\n    },\n    Users() {\n      var t = this.usersID;\n      this.groups.forEach(i => {\n        i.select && (t = t.concat(i.users));\n      });\n      return this.users.map(i => ({\n        id: i.id,\n        name: i.name,\n        follow: i.follow,\n        select: t.some(u => u === i.id)\n      }));\n    },\n    Value() {\n      return this.selectValue;\n    },\n    BW() {\n      var width = 240;\n      if(this.size && this.size[0]) width = this.size[0];\n      if(width < 240) width = 240;\n      return width;\n    },\n    BH() {\n      var height = 100;\n      if(this.size && this.size[1]) height = this.size[1];\n      if(height < 100) width = 100;\n      return height - 34;\n    },\n    panelStyle() {\n      var width = 240, height = 320;\n      if(this.size && this.size[0]) {\n        width = this.size[0];\n        height = this.size[1];\n      }\n      return {\n        width: width + 'px',\n        height: height + 'px'\n      };\n    },\n    bodyStyle() {\n      var width = 260;\n      if(this.size && this.size[0]) width = this.size[0] + 20;\n      return {\n        width: width + 'px'\n      };\n    }\n  },\n  mounted() {\n    this.update();\n  }\n});\n"]}