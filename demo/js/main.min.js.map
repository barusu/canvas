{"version":3,"sources":["demo/script/main.js"],"names":["Vue","component","name","template","props","data","tabID","key","depts","dutys","groups","users","usersID","user","watch","methods","search","_this","this","$emit","status","follow","i","_this2","id","some","u","addUser","_this3","every","push","update","map","select","d","tid","defaultSelect","tem","_this4","value","forEach","toggleDutys","s","cancelUser","_this5","concat","filter","toggleUser","computed","SDepts","SDutys","SUsers","t","Users","Value","mounted"],"mappings":"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","file":"main.min.js","sourcesContent":["Vue.component('o-transfer', {\n  name: 'oTransfer',\n  template: `\n  <div class=\"o-transfer\">\n    <div class=\"transfer-panel\">\n      <div class=\"tab-head\">\n        <div class=\"tab-item\" :class=\"{'select': tabID === 0}\" @click=\"tabID = 0\">\n          <span :data-num=\"SDepts.length\">部门</span>\n        </div>\n        <div class=\"tab-item\" :class=\"{'select': tabID === 1}\" @click=\"tabID = 1\">\n          <span :data-num=\"SDutys.length\">职务</span>\n        </div>\n        <div class=\"tab-item\" :class=\"{'select': tabID === 2}\" @click=\"tabID = 2\">\n          <span>群组</span>\n        </div>\n        <div class=\"tab-item\" :class=\"{'select': tabID === 3}\" @click=\"tabID = 3\">\n          <span :data-num=\"SUsers.length\">用户</span>\n        </div>\n      </div>\n      <div class=\"tab-bar\" :class=\"'seq' + tabID\"></div>\n      <div class=\"tab-content\" :data-key=\"Value.depts.length\">\n        <div class=\"body-wrapper\" :class=\"'seq' + tabID\">\n          <!-- 部门列表 -->\n          <div class=\"body\">\n            <div class=\"content\">\n              <div class=\"item\" v-for=\"i in depts\" :class=\"{'select': i.select}\" v-text=\"i.name\" @click=\"i.select = !i.select\" :key=\"'deptsl' + i.id\"></div>\n            </div>\n          </div>\n          <!-- 职务-部门 列表 -->\n          <div class=\"body\">\n            <div class=\"content dutys\">\n              <div class=\"item\" v-for=\"i in dutys\" :key=\"'dutysl' + i.id\">\n                <p v-text=\"i.name\" @click=\"toggleDutys(i)\" class=\"cup\" title=\"全选 / 取消\"></p>\n                <p class=\"min-tag\"><span v-for=\"d in i.depts\" :key=\"'dutysltag' + d.id\" v-text=\"d.name\" @click=\"d.select = !d.select\" :class=\"{'select': d.select}\"></span></p>\n              </div>\n            </div>\n          </div>\n          <!-- 用户组列表 -->\n          <div class=\"body\">\n            <div class=\"content\">\n              <div class=\"item\" v-for=\"i in groups\" :class=\"{'select': i.select}\" v-text=\"i.name + ' ( ' + i.users.length + ' )'\" @click=\"i.select = !i.select\" :key=\"'groupsl' + i.id\"></div>\n            </div>\n          </div>\n          <!-- 用户列表 -->\n          <div class=\"body\">\n            <div class=\"content\">\n              <div class=\"item\" v-for=\"i in Users\" :class=\"{'select': i.select}\" @click=\"toggleUser(i)\" :key=\"'usersl' + i.id\">\n                <span v-text=\"i.name\"></span>\n                <i class=\"el-icon-star-on\" v-if=\"i.follow\" @click.stop=\"follow(i, false)\" title=\"取消常用联系人\"></i>\n                <i class=\"el-icon-star-off\" v-else @click.stop=\"follow(i, true)\" title=\"添加为常用联系人\"></i>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class=\"transfer-panel\">\n      <!-- 搜索框（添加额外人员） -->\n      <div class=\"tab-head\">\n        <input type=\"text\" class=\"search\" v-model=\"key\" :class=\"{'error': key && !user, 'success': key && user}\" @keyup.enter=\"addUser\">\n        <button type=\"button\" :class=\"{'disable': !user}\" @click=\"addUser\">添加</button>\n      </div>\n      <div class=\"tab-content\">\n        <div class=\"content del\">\n          <!-- 选择的部门 -->\n          <div class=\"item dept\" v-for=\"i in SDepts\" @click=\"i.select = false\" :key=\"'deptsr' + i.id\">\n            <span v-text=\"i.name\"></span>\n            <i class=\"el-icon-delete\"></i>\n          </div>\n          <!-- 选择的职务 -->\n          <div class=\"item duty\" v-for=\"i in SDutys\" :key=\"'dutysr' + i.id\">\n            <p v-text=\"i.name\"></p>\n            <p class=\"min-tag\">\n              <template v-for=\"d in i.depts\"><span class=\"select\" :key=\"d.id\" v-if=\"d.select\" v-text=\"d.name\" @click=\"d.select = false\"></span></template>\n            </p>\n          </div>\n          <!-- 选择的用户 -->\n          <div class=\"item user\" v-for=\"i in SUsers\" @click=\"cancelUser(i.id)\" :key=\"'usersr' + i.id\">\n            <span v-text=\"i.name\"></span>\n            <i class=\"el-icon-delete\"></i>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n  `,\n  props: ['data', 'value'],\n  data() {\n    return {\n      tabID: 0,\n      key: '',\n      depts: [],\n      dutys: [],\n      groups: [],\n      users: [],\n      usersID: [],\n      user: null\n    };\n  },\n  watch: {\n    data: 'update',\n    key: 'search'\n  },\n  methods: {\n    search() {\n      this.$emit('search', this.key, data => {\n        if(data.status) this.user = data.user;\n        else this.user = null;\n      });\n    },\n    follow(i, status) {\n      this.$emit('follow', {id: i.id, name: i.name, follow: status}, data => {\n        if(data.status) this.users.some(u => {\n          if(u.id == i.id) {\n            u.follow = status;\n            return true;\n          }else return false;\n        });\n      });\n    },\n    addUser() {\n      if(this.user) {\n        this.user.follow = false;\n        if(this.users.every(i => i.id != this.user.id)) this.users.push(this.user);\n        this.usersID.push(this.user.id);\n        this.key = '';\n      }\n    },\n    update() {\n      this.depts = this.data.depts.map(i => {\n        return {\n          select: false,\n          id: i.id,\n          name: i.name\n        };\n      });\n      this.dutys = this.data.dutys.map(i => {\n        return {\n          id: i.id,\n          name: i.name,\n          depts: i.depts.map(d => {\n            return {\n              id: d.id,\n              name: d.name,\n              tid: d.tid,\n              select: false\n            };\n          })\n        };\n      });\n      this.groups = this.data.groups.map(i => {\n        return {\n          id: i.id,\n          name: i.name,\n          select: false,\n          users: i.users.map(u => u.id)\n        };\n      });\n      this.users = this.data.users.map(i => ({id: i.id, name: i.name, follow: true}));\n      this.defaultSelect();\n    },\n    defaultSelect() {\n      var tem;\n      if(this.value) {\n        if(this.value.depts) {\n          tem = {};\n          this.value.depts.forEach(i => {\n            tem[i.id] = true;\n          });\n          this.depts.forEach(i => {\n            if(tem[i.id]) i.select = true;\n          });\n        }\n        if(this.value.dutys) {\n          tem = {};\n          this.value.dutys.forEach(d => {\n            d.depts.forEach(i => {\n              tem[d.id + '-' + i.id] = true;\n            });\n          });\n          this.dutys.forEach(d => {\n            d.depts.forEach(i => {\n              if(tem[d.id + '-' + i.id]) i.select = true;\n            });\n          });\n        }\n        if(this.value.users) {\n          this.value.users.forEach(u => {\n            if(this.users.every(i => i.id != u.id)) this.users.push({id: u.id, name: u.name, follow: false});\n            this.usersID.push(u.id);\n          });\n        }\n      }\n    },\n    toggleDutys(i) {\n      var s = i.depts.every(d => d.select);\n      i.depts.forEach(d => {d.select = !s;});\n    },\n    cancelUser(id) {\n      this.groups.forEach(i => {\n        if(i.select && i.users.some(u => u == id)) {\n          i.select = false;\n          this.usersID = this.usersID.concat(i.users.filter(u => u != id));\n        }\n      });\n      this.usersID = this.usersID.filter(i => i != id);\n    },\n    toggleUser(i) {\n      if(i.select) this.cancelUser(i.id);\n      else this.usersID.push(i.id);\n    }\n  },\n  computed: {\n    SDepts() {\n      return this.depts.filter(i => i.select);\n    },\n    SDutys() {\n      return this.dutys.filter(i => i.depts.some(d => d.select));\n    },\n    SUsers() {\n      var t = this.usersID;\n      this.groups.forEach(i => {\n        i.select && (t = t.concat(i.users));\n      });\n      return this.users.filter(i => t.some(u => u == i.id));\n    },\n    Users() {\n      var t = this.usersID;\n      this.groups.forEach(i => {\n        i.select && (t = t.concat(i.users));\n      });\n      return this.users.map(i => {\n        return {\n          id: i.id,\n          name: i.name,\n          follow: i.follow,\n          select: t.some(u => u == i.id)\n        };\n      });\n    },\n    Value() {\n      var tem = {\n        \"depts\": this.SDepts.map(i => ({id: i.id, name: i.name})),\n        \"dutys\": this.SDutys.map(i => {\n          return {\n            id: i.id,\n            name: i.name,\n            depts: i.depts.filter(d => d.select).map(d => ({id: d.id, name: d.name, tid: d.tid}))\n          };\n        }),\n        \"users\": this.SUsers.map(i => ({id: i.id, name: i.name}))\n      };\n      this.$emit('change');\n      return tem;\n    }\n  },\n  mounted() {\n    this.update();\n  }\n});\n"]}