"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){var s,i,o,e={_sequence:0,set sequence(t){this._sequence=this._sequence<t?t:this._sequence},get sequence(){return++this._sequence}},n={arr:[],getPointInMatrix:function(i,o,t){for(var n,h,r,s=this,u=0;;)if(this.arr[u]){if(n=0,this.arr[u].some(function(t,e){if(0===t?n++:n=0,i<=n){h=1;t:for(;;){if(o<=h)return n=++e,!0;if(s.arr[u+h]){for(r=0;r<i;r++)if(0!==s.arr[u+h][e-r])break t;h++}else s.arr.push(Array(12).fill(0)),h++}}return!1}))break;u++}else this.arr.push(Array(12).fill(0));t.ox=t.x=n-i,t.oy=t.y=u},add:function(t){var e,i;for(e=0;e<t.width;e++)for(i=0;i<t.height;i++)this.arr[t.y+i][t.x+e]=t.id;s.lines=this.arr.length},insert:function(e){var t,i,o,n=this,h=[];for(i=0;i<e.width;i++)for(o=0;o<e.height;o++)this.arr[e.y+o]?0!==this.arr[e.y+o][e.x+i]&&(h[t=this.arr[e.y+o][e.x+i]]=h[t]||t,this.delete(t)):this.arr[e.y+o]=Array(12).fill(0);this.add(e),h.forEach(function(t){n.resetBox(s.getItem(t),e)})},delete:function(o){this.arr.forEach(function(i){i.forEach(function(t,e){t===o&&(i[e]=0)})})},update:function(t){this.delete(t.id),this.insert(t)},resetBox:function(t,e){var i,o=4,n=0,h=[!0,!0,!0,!0,!0];for(u[t.id]=t;o&&(n++,!h[4]||(!1===(i=this.checkMatrix(t.ox,t.ox+t.width,t.oy,t.oy+t.height,e.id))&&(h[4]=!1),!i))&&(!h[0]||(!1===(i=this.checkMatrix(t.ox,t.ox+t.width,t.oy-n,t.oy+t.height-n,e.id))&&(h[0]=!1,o--),!i))&&(!h[1]||(!1===(i=this.checkMatrix(t.ox-n,t.ox+t.width-n,t.oy,t.oy+t.height,e.id))&&(h[1]=!1,o--),!i))&&(!h[2]||(!1===(i=this.checkMatrix(t.ox+n,t.ox+t.width+n,t.oy,t.oy+t.height,e.id))&&(h[2]=!1,o--),!i))&&(!h[3]||(!1===(i=this.checkMatrix(t.ox,t.ox+t.width,t.oy+n,t.oy+t.height+n,e.id))&&(h[3]=!1,o--),!i)););return i?(t.x=i.x,t.y=i.y,this.add(t),!0):(e&&(t.y=e.y+e.height,this.insert(t)),!1)},checkMatrix:function(t,e,i,o,n){if((void 0===t?"undefined":_typeof(t))!==_typeof(0)||(void 0===e?"undefined":_typeof(e))!==_typeof(0)||(void 0===i?"undefined":_typeof(i))!==_typeof(0)||(void 0===o?"undefined":_typeof(o))!==_typeof(0))return!1;var h;if(n=n||0,t<0||12<e||i<0)return!1;for(var r={x:t,y:i};i<o;i++)if(this.arr[i]){for(h=t;h<e;h++)if(this.arr[i][h]&&(r=null,this.arr[i][h]!==n))return!1}else this.arr[i]=Array(12).fill(0);return r},deleteBlankLine:function(){var i,o,n=[],h=0,r=[];for(this.arr.forEach(function(t,e){i=!0,t.forEach(function(t){0!==t&&(i=!1,r[t]||(r[t]=!0,h&&((o=s.getItem(t)).oy=o.y=o.y-h,o.update())))}),i&&(h++,n.push(e))});n.length;)this.arr.splice(n.pop(),1)}},h=50,r=10,u=[];function c(){this.id=e.sequence,this.width=4,this.height=3,this.minWidth=1,this.minHeight=1,this.x=0,this.y=0,this.ox=0,this.oy=0,this.background="#f6f",n.getPointInMatrix(this.width,this.height,this),n.add(this),this.style={top:r*this.y+"px",left:h*this.x+"px",width:this.width*h+"px",height:this.height*r+"px",background:this.background}}function d(t){if(o){var e=t||window.event;i.type?(o.style.left=h*o.ox+e.clientX-i.x+"px",o.style.top=r*o.oy+e.clientY-i.y+"px",o.x=o.ox+Math.round((e.clientX-i.x)/h),o.y=o.oy+Math.round((e.clientY-i.y)/r),o.x<0&&(o.x=0),o.y<0&&(o.y=0),12<o.x+o.width&&(o.x=12-o.width)):(o.style.width=h*i.w+e.clientX-i.x+"px",o.style.height=r*i.h+e.clientY-i.y+"px",h*i.w+e.clientX-i.x<h*o.minWidth&&(o.style.width=h*o.minWidth+"px"),r*i.h+e.clientY-i.y<r*o.minHeight&&(o.style.height=r*o.minHeight+"px"),o.w=i.w+Math.round((e.clientX-i.x)/h),o.h=i.h+Math.round((e.clientY-i.y)/r),12<o.x+o.w&&(o.w=12-o.x),o.w<o.minWidth&&(o.w=o.minWidth),o.h<o.minHeight&&(o.h=o.minHeight)),n.update(o),l()}}var f=!(c.prototype.update=function(){this.style={top:r*this.y+"px",left:h*this.x+"px",width:this.width*h+"px",height:this.height*r+"px",background:this.background}});function l(){f?setTimeout(l,40):a()}function a(){var e=!1;u.forEach(function(t){t&&(n.delete(t.id),n.resetBox(t,!1)?(t.ox===t.x&&t.oy===t.y&&(u[t.id]=null),e=!0):n.add(t),t.update())}),e?(setTimeout(a,40),f=!0):f=!1}function y(){o&&(o.ox=o.x,o.oy=o.y,u.forEach(function(t){t&&(t.ox=t.x,t.oy=t.y)}),u=[],o.update(),o=null,n.deleteBlankLine(),s.lines=n.arr.length,s.murdererID=0),window.removeEventListener("mousemove",d),window.removeEventListener("mouseup",y)}s=new Vue({el:"#main",data:{blocks:[],murdererID:0,lines:0},methods:{move:function(t){y(),2!==event.button&&(this.murdererID=t.id,o=t,i={x:event.clientX,y:event.clientY,type:!0},window.addEventListener("mousemove",d),window.addEventListener("mouseup",y))},getItem:function(t){for(var e=0;e<this.blocks.length;e++)if(this.blocks[e].id===t)return this.blocks[e]}},mounted:function(){var t=this;this.$nextTick(function(){h=Math.floor(t.$el.clientWidth/12),t.blocks.push(new c),t.blocks.push(new c),t.blocks.push(new c),t.blocks.push(new c),t.blocks.push(new c),t.blocks.push(new c),t.blocks.push(new c),t.blocks.push(new c),t.blocks.push(new c),t.blocks.push(new c),t.blocks.push(new c),console.log(n),console.log(t.blocks)})}})}(window);
//# sourceMappingURL=main.js.map
