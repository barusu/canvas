"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){var s,i,n,e={_sequence:0,set sequence(t){this._sequence=this._sequence<t?t:this._sequence},get sequence(){return++this._sequence}},h={arr:[],getPointInMatrix:function(i,n,t){for(var h,o,r,s=this,d=0;;)if(this.arr[d]){if(h=0,this.arr[d].some(function(t,e){if(0===t?h++:h=0,i<=h){o=1;t:for(;;){if(n<=o)return h=++e,!0;if(s.arr[d+o]){for(r=0;r<i;r++)if(0!==s.arr[d+o][e-r])break t;o++}else s.arr.push(Array(12).fill(0)),o++}}return!1}))break;d++}else this.arr.push(Array(12).fill(0));t.ox=t.x=h-i,t.oy=t.y=d},add:function(t){var e,i;for(e=0;e<t.width;e++)for(i=0;i<t.height;i++)this.arr[t.y+i][t.x+e]=t.id;s.lines=this.arr.length},insert:function(e){var t,i,n,h=this,o=[];for(i=0;i<e.width;i++)for(n=0;n<e.height;n++)this.arr[e.y+n]?0!==this.arr[e.y+n][e.x+i]&&(o[t=this.arr[e.y+n][e.x+i]]=o[t]||t,this.delete(t)):this.arr[e.y+n]=Array(12).fill(0);this.add(e),o.forEach(function(t){h.resetBox(s.getItem(t),e)})},delete:function(n){this.arr.forEach(function(i){i.forEach(function(t,e){t===n&&(i[e]=0)})})},update:function(t){this.delete(t.id),this.insert(t)},resetBox:function(t,e){var i,n=4,h=0,o=[!0,!0,!0,!0,!0];for(d[t.id]=t;n&&(h++,!o[4]||(!1===(i=this.checkMatrix(t.ox,t.ox+t.width,t.oy,t.oy+t.height,e.id))&&(o[4]=!1),!i))&&(!o[0]||(!1===(i=this.checkMatrix(t.ox,t.ox+t.width,t.oy-h,t.oy+t.height-h,e.id))&&(o[0]=!1,n--),!i))&&(!o[1]||(!1===(i=this.checkMatrix(t.ox-h,t.ox+t.width-h,t.oy,t.oy+t.height,e.id))&&(o[1]=!1,n--),!i))&&(!o[2]||(!1===(i=this.checkMatrix(t.ox+h,t.ox+t.width+h,t.oy,t.oy+t.height,e.id))&&(o[2]=!1,n--),!i))&&(!o[3]||(!1===(i=this.checkMatrix(t.ox,t.ox+t.width,t.oy+h,t.oy+t.height+h,e.id))&&(o[3]=!1,n--),!i)););return i?(t.x=i.x,t.y=i.y,this.add(t),!0):(e&&(t.y=e.y+e.height,this.insert(t)),!1)},checkMatrix:function(t,e,i,n,h){if((void 0===t?"undefined":_typeof(t))!==_typeof(0)||(void 0===e?"undefined":_typeof(e))!==_typeof(0)||(void 0===i?"undefined":_typeof(i))!==_typeof(0)||(void 0===n?"undefined":_typeof(n))!==_typeof(0))return!1;var o;if(h=h||0,t<0||12<e||i<0)return!1;for(var r={x:t,y:i};i<n;i++)if(this.arr[i]){for(o=t;o<e;o++)if(this.arr[i][o]&&(r=null,this.arr[i][o]!==h))return!1}else this.arr[i]=Array(12).fill(0);return r},deleteBlankLine:function(){var i,n,h=[],o=0,r=[];for(this.arr.forEach(function(t,e){i=!0,t.forEach(function(t){0!==t&&(i=!1,r[t]||(r[t]=!0,o&&((n=s.getItem(t)).oy=n.y=n.y-o,n.update())))}),i&&(o++,h.push(e))});h.length;)this.arr.splice(h.pop(),1)}},o=50,r=10,d=[];function u(){this.id=e.sequence,this.width=4,this.height=10,this.minWidth=1,this.minHeight=5,this.x=0,this.y=0,this.ox=0,this.oy=0,this.background="#f6f",h.getPointInMatrix(this.width,this.height,this),h.add(this),this.style={top:r*this.y+"px",left:o*this.x+"px",width:this.width*o+"px",height:this.height*r+"px",background:this.background}}function c(t){if(n){var e=t||window.event;i.type?(n.style.left=o*n.ox+e.clientX-i.x+"px",n.style.top=r*n.oy+e.clientY-i.y+"px",n.x=n.ox+Math.round((e.clientX-i.x)/o),n.y=n.oy+Math.round((e.clientY-i.y)/r),n.x<0&&(n.x=0),n.y<0&&(n.y=0),12<n.x+n.width&&(n.x=12-n.width)):(n.style.width=o*i.width+e.clientX-i.x+"px",n.style.height=r*i.height+e.clientY-i.y+"px",o*i.width+e.clientX-i.x<o*n.minWidth&&(n.style.width=o*n.minWidth+"px"),r*i.height+e.clientY-i.y<r*n.minHeight&&(n.style.height=r*n.minHeight+"px"),n.width=i.width+Math.round((e.clientX-i.x)/o),n.height=i.height+Math.round((e.clientY-i.y)/r),12<n.x+n.width&&(n.width=12-n.x),n.width<n.minWidth&&(n.width=n.minWidth),n.height<n.minHeight&&(n.height=n.minHeight)),h.update(n),l()}}var f=!(u.prototype.update=function(){this.style={top:r*this.y+"px",left:o*this.x+"px",width:this.width*o+"px",height:this.height*r+"px",background:this.background}});function l(){f?setTimeout(l,40):a()}function a(){var e=!1;d.forEach(function(t){t&&(h.delete(t.id),h.resetBox(t,!1)?(t.ox===t.x&&t.oy===t.y&&(d[t.id]=null),e=!0):h.add(t),t.update())}),e?(setTimeout(a,40),f=!0):f=!1}function y(){n&&(n.ox=n.x,n.oy=n.y,d.forEach(function(t){t&&(t.ox=t.x,t.oy=t.y)}),d=[],n.update(),n=null,h.deleteBlankLine(),s.lines=h.arr.length,s.murdererID=0),window.removeEventListener("mousemove",c),window.removeEventListener("mouseup",y)}s=new Vue({el:"#main",data:{blocks:[],murdererID:0,lines:0},methods:{move:function(t){y(),2!==event.button&&(this.murdererID=t.id,n=t,i={x:event.clientX,y:event.clientY,type:!0},window.addEventListener("mousemove",c),window.addEventListener("mouseup",y))},resize:function(t){y(),2!==event.button&&(this.murdererID=t.id,n=t,i={x:event.clientX,y:event.clientY,width:t.width,height:t.height,type:!1},window.addEventListener("mousemove",c),window.addEventListener("mouseup",y))},getItem:function(t){for(var e=0;e<this.blocks.length;e++)if(this.blocks[e].id===t)return this.blocks[e]}},mounted:function(){var t=this;this.$nextTick(function(){o=Math.floor(t.$el.clientWidth/12),t.blocks.push(new u),t.blocks.push(new u),t.blocks.push(new u),t.blocks.push(new u),t.blocks.push(new u),t.blocks.push(new u),t.blocks.push(new u),t.blocks.push(new u),t.blocks.push(new u),t.blocks.push(new u),t.blocks.push(new u),console.log(h),console.log(t.blocks)})}})}(window);
//# sourceMappingURL=main.js.map
