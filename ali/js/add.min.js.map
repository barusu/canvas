{"version":3,"sources":["ali/script/add.js"],"names":["scope","Add","Vue","el","data","step","resource","chineseName","englishName","description","applicationSystem_id","abutments","amount","renewFrequency","renewFrequencyReason","remark","resourceRules","required","trigger","applicationSystems","name","id","code","amounts","renewFrequencys","dataIndexs","openProperty","shareProperty","type","length","symbols","isKey","defaultValue","allowSpace","remarks","dataFormat","dataindex","dataindexRules","validator","rule","value","callback","Error","boolmap","0","1","dialogFormVisible","dataFormatMap","CHAR","VARCHAR","INT","BIGINT","NUMERIC","YEAR","DATE","DATETIME","TIMESTAMP","TEXT","BLOB","DECIMAL","DOUBLE","FLOAT","SMALLINT","TINYINT","VARBINARY","LONGBLOB","LONGTEXT","MEDIUMTEXT","methods","next","formName","_this","this","$refs","validate","valid","pre","addindex","_this2","$forceUpdate","dialogform","push","clearValidate","$nextTick","edit","s","console","log","$index","deleterow","splice","cknull","row","column","cellValue","index","$createElement","class","ckunique","unique","forEach","i","property","computed","IndexType","tem","k","ilength","set","v","get","f","max","split","parseInt","isNaN","toString","x","window"],"mappings":"cAAA,SAAUA,GAgCR,IAAIC,EAAM,IAAIC,IAAI,CAChBC,GAAI,OACJC,KAAM,CACJC,KAAM,EAENC,SAlBK,CACLC,YAAY,GACZC,YAAY,GACZC,YAAY,GACZC,qBAAqB,GACrBC,UAAU,GACVC,OAAO,GACPC,eAAe,GACfC,qBAAqB,GACrBC,OAAO,IAUPC,cAAe,CACbT,YAAa,CAAC,CAAEU,UAAU,EAAMC,QAAS,SACzCV,YAAa,CAAC,CAAES,UAAU,EAAMC,QAAS,SACzCR,qBAAsB,CAAC,CAAEO,UAAU,EAAMC,QAAS,WAClDP,UAAW,CAAC,CAAEM,UAAU,EAAMC,QAAS,WACvCN,OAAQ,CAAC,CAAEK,UAAU,EAAMC,QAAS,WACpCL,eAAgB,CAAC,CAAEI,UAAU,EAAMC,QAAS,YAE9CC,mBAAmB,CAAC,CAACC,KAAO,SAASC,GAAK,MAC1CV,UAAU,CAAC,CAACS,KAAO,OAAOE,KAAO,YAAY,CAACF,KAAO,UAAUE,KAAO,UACtEC,QAAQ,CAAC,CAACH,KAAO,QAAQE,KAAO,MAChCE,gBAAgB,CAAC,CAACJ,KAAO,IAAIE,KAAO,OAAO,CAACF,KAAO,IAAIE,KAAO,SAAS,CAACF,KAAO,IAAIE,KAAO,SAE1FG,WAAW,CACT,CACElB,YAAa,GACbmB,aAAc,KACdC,cAAe,QACfnB,YAAa,MACboB,KAAM,GACNC,OAAQ,GACRC,QAAS,IACTC,MAAO,IACPC,aAAc,GACdC,WAAY,IACZC,QAAS,GACTC,WAAY,IACX,CACD5B,YAAa,GACbmB,aAAc,KACdC,cAAe,QACfnB,YAAa,MACboB,KAAM,MACNC,OAAQ,QACRC,QAAS,IACTC,MAAO,IACPC,aAAc,GACdC,WAAY,IACZC,QAAS,GACTC,WAAY,IACX,CACD5B,YAAa,GACbmB,aAAc,KACdC,cAAe,QACfnB,YAAa,MACboB,KAAM,GACNC,OAAQ,GACRC,QAAS,IACTC,MAAO,IACPC,aAAc,GACdC,WAAY,IACZC,QAAS,GACTC,WAAY,KAGhBC,UA3FK,CACL7B,YAAa,GACbmB,aAAc,KACdC,cAAe,QACfnB,YAAa,GACboB,KAAM,GACNC,OAAQ,GACRC,QAAS,IACTC,MAAO,IACPC,aAAc,GACdC,WAAY,IACZC,QAAS,GACTC,WAAY,IAgFZE,eAAgB,CACd9B,YAAa,CAAC,CAAEU,UAAU,EAAMC,QAAS,SACzCV,YAAa,CAAC,CAAES,UAAU,EAAMC,QAAS,SACzCU,KAAM,CAAC,CAAEX,UAAU,EAAMC,QAAS,WAClCW,OAAQ,CAAC,CAAES,UAAW,SAACC,EAAMC,EAAOC,GAClC,OAAOxC,EAAImC,UAAUR,MACnB,IAAK,UACL,IAAK,MACL,IAAK,SACL,IAAK,UACAY,EAAOC,IACLA,EAAS,IAAIC,MAAM,WACxB,MACF,QACED,MAEHvB,QAAS,UAEdyB,QAAS,CAACC,EAAG,IAAKC,EAAG,KACrBC,mBAAmB,EACnBC,cAAe,CACbC,KAAM,MACNC,QAAS,MACTC,IAAK,MACLC,OAAQ,MACRC,QAAS,MACTC,KAAM,OACNC,KAAM,aACNC,SAAU,sBACVC,UAAW,WACXC,KAAM,QACNC,KAAM,QACNC,QAAS,MACTC,OAAQ,MACRC,MAAO,MACPC,SAAU,MACVC,QAAS,MACTC,UAAW,MACXC,SAAU,QACVC,SAAU,QACVC,WAAY,UAGhBC,QAAS,CACPC,KADO,SACFC,GAAU,IAAAC,EAAAC,KACbA,KAAKC,MAAMH,GAAUI,SAAS,SAAAC,GAC5B,IAAGA,EAGD,OAAO,EAFPJ,EAAKlE,KAAO,KAMlBuE,IAVO,WAWLJ,KAAKnE,KAAO,GAEdwE,SAbO,WAaI,IAAAC,EAAAN,KACTA,KAAKO,eACLP,KAAKC,MAAMO,WAAWN,SAAS,SAAAC,GAC7B,IAAGA,EAOG,OAAO,EANXG,EAAKrD,WAAWwD,KAAKH,EAAK1C,WAC1B0C,EAAKL,MAAMO,WAAWE,gBAEtBJ,EAAKK,UAAU,WACbL,EAAK1C,UA5JR,CACL7B,YAAa,GACbmB,aAAc,KACdC,cAAe,QACfnB,YAAa,GACboB,KAAM,GACNC,OAAQ,GACRC,QAAS,IACTC,MAAO,IACPC,aAAc,GACdC,WAAY,IACZC,QAAS,GACTC,WAAY,SAqJZiD,KA1BO,SA0BFC,GACHC,QAAQC,IAAIF,GACZb,KAAKpC,UAAYoC,KAAK/C,WAAW4D,EAAEG,QACnChB,KAAK1B,mBAAoB,GAE3B2C,UA/BO,SA+BGJ,GACRb,KAAK/C,WAAWiE,OAAOL,EAAEG,OAAQ,IAEnCG,OAlCO,SAkCAC,EAAKC,EAAQC,EAAWC,GAC7B,OAAGD,GACStB,KAAKwB,eAAe,OAAQ,CAACC,MAAO,KAAM,KAExDC,SAtCO,SAsCEN,EAAKC,EAAQC,EAAWC,GAC/B,IAAII,EAAS,EAIb,OAHA3B,KAAK/C,WAAW2E,QAAQ,SAAAC,GACnBA,EAAER,EAAOS,WAAaR,GAAWK,MAE1B,EAATA,EACM3B,KAAKwB,eAAe,OAAQ,CAACC,MAAO,UAAWH,GAC/CA,GACGtB,KAAKwB,eAAe,OAAQ,CAACC,MAAO,KAAM,MAG1DM,SAAU,CACRC,UADQ,WAEN,IAAIC,EAAM,GACV,IAAI,IAAIC,KAAKlC,KAAKzB,cAChB0D,EAAIxB,KAAK,CAAC7D,KAAMsF,EAAGlE,MAAOkE,IAE5B,OAAOD,GAETE,QAAS,CACPC,IAAK,SAASC,GACZrC,KAAKpC,UAAUP,OAASgF,GAE1BC,IAAK,WACH,IACoBC,EAAGN,EADnBI,EAAIrC,KAAKpC,UAAUP,OACnBmF,EAAM,SACV,OAAOxC,KAAKpC,UAAUR,MACpB,IAAK,UAAWoF,EAAM,IAAM,MAC5B,IAAK,MAAOA,EAAM,IAAK,MACvB,IAAK,SACHA,EAAM,IAENH,GADAJ,EAAMI,EAAEI,MAAM,MACN,GACRF,EAAIN,EAAI,GACR,MACF,IAAK,OACL,IAAK,QACHO,EAAM,IAENH,GADAJ,EAAMI,EAAEI,MAAM,MACN,GACRF,EAAIN,EAAI,GACR,MACF,IAAK,WACL,IAAK,WACL,IAAK,OACL,IAAK,aAAc,MACnB,IAAK,WACL,IAAK,SACL,IAAK,UAAWO,EAAM,IAAK,MAC3B,IAAK,YAAaA,EAAM,IAAK,MAC7B,IAAK,UAML,IAAK,UACHA,EAAM,GAENH,GADAJ,EAAMI,EAAEI,MAAM,MACN,GACRF,EAAIN,EAAI,GAgBZ,OAZAI,EAAIK,SAASL,GACVM,MAAMN,GAAMA,EAAI,EACXA,EAAI,EAAKA,EAAI,EACTG,EAAJH,IAAWA,EAAIG,GACG,WAAvBxC,KAAKpC,UAAUR,MAA4C,UAAvB4C,KAAKpC,UAAUR,MAA2C,SAAvB4C,KAAKpC,UAAUR,MAA0C,WAAvB4C,KAAKpC,UAAUR,OACzHmF,EAAIG,SAASH,GACVI,MAAMJ,GAAMA,EAAI,EACXA,EAAI,EAAKA,EAAI,EACTF,EAAJE,IAASA,EAAIF,GACrBA,GAAK,IAAME,GAEbvC,KAAKpC,UAAUP,OAASgF,EAAEO,WACnB5C,KAAKpC,UAAUP,SAG1BE,MAAO,CACL+E,IAAK,WACH,MAA2B,KAAxBtC,KAAKpC,UAAUL,OAGpB6E,IAAK,SAASC,GACLrC,KAAKpC,UAAUL,MAAnB8E,EAA2B,IACD,MAGjC5E,WAAY,CACV6E,IAAK,WACH,MAAgC,KAA7BtC,KAAKpC,UAAUH,YAGpB2E,IAAK,SAASC,GACLrC,KAAKpC,UAAUH,WAAnB4E,EAAgC,IACD,MAGtC/E,QAAS,CACPgF,IAAK,WACH,MAA8B,MAA3BtC,KAAKpC,UAAUN,SAGpB8E,IAAK,SAASC,GACLrC,KAAKpC,UAAUN,QAAnB+E,EAA6B,IACD,MAGnC1E,WAlGQ,WAmGN,IAAIkF,EAAI7C,KAAKzB,cAAcyB,KAAKpC,UAAUR,MAI1C,OAHGyF,GAAe,GAAZA,EAAExF,SACNwF,GAAK7C,KAAKpC,UAAUP,QAEfwF,MAjSf,CAqSGC","file":"add.min.js","sourcesContent":["(function(scope) {\n  function getDefaultIndex() {\n    return {\n      chineseName: '',\n      openProperty: '开放',\n      shareProperty: '无条件共享',\n      englishName: '',\n      type: '',\n      length: '',\n      symbols: '否',\n      isKey: '0',\n      defaultValue: '',\n      allowSpace: '1',\n      remarks: '',\n      dataFormat: ''\n    };\n  }\n\n  function getResource(){\n    return {\n      chineseName:'',\n      englishName:'',\n      description:'',\n      applicationSystem_id:'',\n      abutments:'',\n      amount:'',\n      renewFrequency:'',\n      renewFrequencyReason:'',\n      remark:''\n    }\n  }\n\n  var Add = new Vue({\n    el: '#add',\n    data: {\n      step: 0,\n      // step 1\n      resource: getResource(),\n      resourceRules: {\n        chineseName: [{ required: true, trigger: 'blur'}],\n        englishName: [{ required: true, trigger: 'blur'}],\n        applicationSystem_id: [{ required: true, trigger: 'change'}],\n        abutments: [{ required: true, trigger: 'change'}],\n        amount: [{ required: true, trigger: 'change'}],\n        renewFrequency: [{ required: true, trigger: 'change'}]\n      },\n      applicationSystems:[{\"name\":\"数据治理系统\",\"id\":\"1\"}],\n      abutments:[{\"name\":\"库表对接\",\"code\":\"database\"},{\"name\":\"excel文件\",\"code\":\"excel\"}],\n      amounts:[{\"name\":\"0~1千万\",\"code\":\"1\"}],\n      renewFrequencys:[{\"name\":\"天\",\"code\":\"day\"},{\"name\":\"月\",\"code\":\"month\"},{\"name\":\"年\",\"code\":\"year\"}],\n      // step 2\n      dataIndexs:[\n        {\n          chineseName: '',\n          openProperty: '开放',\n          shareProperty: '无条件共享',\n          englishName: '122',\n          type: '',\n          length: '',\n          symbols: '否',\n          isKey: '0',\n          defaultValue: '',\n          allowSpace: '1',\n          remarks: '',\n          dataFormat: ''\n        }, {\n          chineseName: '',\n          openProperty: '开放',\n          shareProperty: '无条件共享',\n          englishName: '222',\n          type: 'INT',\n          length: '66666',\n          symbols: '否',\n          isKey: '0',\n          defaultValue: '',\n          allowSpace: '1',\n          remarks: '',\n          dataFormat: ''\n        }, {\n          chineseName: '',\n          openProperty: '开放',\n          shareProperty: '无条件共享',\n          englishName: '122',\n          type: '',\n          length: '',\n          symbols: '否',\n          isKey: '0',\n          defaultValue: '',\n          allowSpace: '1',\n          remarks: '',\n          dataFormat: ''\n        }\n      ],\n      dataindex: getDefaultIndex(),\n      dataindexRules: {\n        chineseName: [{ required: true, trigger: 'blur'}],\n        englishName: [{ required: true, trigger: 'blur'}],\n        type: [{ required: true, trigger: 'change'}],\n        length: [{ validator: (rule, value, callback) => {\n          switch(Add.dataindex.type) {\n            case 'VARCHAR':\n            case 'INT':\n            case 'BIGINT':\n            case 'NUMERIC':\n              if(value) callback();\n              else callback(new Error('长度不能为空'));\n              break;\n            default:\n              callback();\n          }\n        }, trigger: 'blur'}]\n      },\n      boolmap: {0: '否', 1: '是'},\n      dialogFormVisible: false,\n      dataFormatMap: {\n        CHAR: 'C..',\n        VARCHAR: 'C..',\n        INT: 'n..',\n        BIGINT: 'n..',\n        NUMERIC: 'N..',\n        YEAR: 'YYYY',\n        DATE: 'YYYY-MM-DD',\n        DATETIME: 'YYYY-MM-DD hh:mm:ss',\n        TIMESTAMP: 'hh:mm:ss',\n        TEXT: 'C..ul',\n        BLOB: 'C..ul',\n        DECIMAL: 'n..',\n        DOUBLE: 'n..',\n        FLOAT: 'n..',\n        SMALLINT: 'n..',\n        TINYINT: 'n..',\n        VARBINARY: 'n..',\n        LONGBLOB: 'C..ul',\n        LONGTEXT: 'C..ul',\n        MEDIUMTEXT: 'C..ul'\n      }\n    },\n    methods: {\n      next(formName) {\n        this.$refs[formName].validate(valid => {\n          if(valid) {\n            this.step = 1;\n          }else {\n            return false;\n          }\n        });\n      },\n      pre() {\n        this.step = 0;\n      },\n      addindex() {\n        this.$forceUpdate();\n        this.$refs.dialogform.validate(valid => {\n          if(valid) {\n            this.dataIndexs.push(this.dataindex);\n            this.$refs.dialogform.clearValidate();\n            // console.log(this.dataIndexs);\n            this.$nextTick(() => {\n              this.dataindex = getDefaultIndex();\n            });\n          }else return false;\n        });\n      },\n      edit(s) {\n        console.log(s);\n        this.dataindex = this.dataIndexs[s.$index];\n        this.dialogFormVisible = true;\n      },\n      deleterow(s) {\n        this.dataIndexs.splice(s.$index, 1);\n      },\n      cknull(row, column, cellValue, index) {\n        if(cellValue) return cellValue;\n        else return this.$createElement('span', {class: 'h'}, '');\n      },\n      ckunique(row, column, cellValue, index) {\n        var unique = 0;\n        this.dataIndexs.forEach(i => {\n          if(i[column.property] == cellValue) unique++;\n        });\n        if(unique > 1) {\n          return this.$createElement('span', {class: 'unique'}, cellValue);\n        }else if(cellValue) return cellValue;\n        else return this.$createElement('span', {class: 'h'}, '');\n      }\n    },\n    computed: {\n      IndexType() {\n        var tem = [];\n        for(var k in this.dataFormatMap) {\n          tem.push({name: k, value: k});\n        }\n        return tem;\n      },\n      ilength: {\n        set: function(v) {\n          this.dataindex.length = v;\n        },\n        get: function() {\n          var v = this.dataindex.length;\n          var max = 99999999, f, tem;\n          switch(this.dataindex.type) {\n            case 'VARCHAR': max = 6000; break;\n            case 'INT': max = 200; break;\n            case 'DOUBLE':\n              max = 255;\n              tem = v.split(',');\n              v = tem[0];\n              f = tem[1];\n              break;\n            case 'CHAR':\n            case 'FLOAT':\n              max = 255;\n              tem = v.split(',');\n              v = tem[0];\n              f = tem[1];\n              break;\n            case 'LONGBLOB':\n            case 'LONGTEXT':\n            case 'TEXT':\n            case 'MEDIUMTEXT': break;\n            case 'SMALLINT':\n            case 'BIGINT':\n            case 'TINYINT': max = 255; break;\n            case 'VARBINARY': max = 100; break;\n            case 'NUMERIC':\n              max = 65;\n              tem = v.split(',');\n              v = tem[0];\n              f = tem[1];\n              break;\n            case 'DECIMAL':\n              max = 65;\n              tem = v.split(',');\n              v = tem[0];\n              f = tem[1];\n              break;\n            default:;\n          }\n          v = parseInt(v);\n          if(isNaN(v)) { v = 0;}\n          else if(v < 0) { v = 0;}\n          else if(v > max) { v = max;}\n          if(this.dataindex.type == 'NUMERIC' || this.dataindex.type == 'DOUBLE' || this.dataindex.type == 'FLOAT' || this.dataindex.type == 'DECIMAL') {\n            f = parseInt(f);\n            if(isNaN(f)) { f = 0;}\n            else if(f < 0) { f = 0;}\n            else if(f > v) { f = v;}\n            v += ',' + f;\n          }\n          this.dataindex.length = v.toString();\n          return this.dataindex.length;\n        }\n      },\n      isKey: {\n        get: function() {\n          if(this.dataindex.isKey == '1') {return true; }\n          else {return false; }\n        },\n        set: function(v) {\n          if(v) {this.dataindex.isKey = '1'; }\n          else {this.dataindex.isKey = '0'; }\n        }\n      },\n      allowSpace: {\n        get: function() {\n          if(this.dataindex.allowSpace == '1') {return true; }\n          else {return false; }\n        },\n        set: function(v) {\n          if(v) {this.dataindex.allowSpace = '1'; }\n          else {this.dataindex.allowSpace = '0'; }\n        }\n      },\n      symbols: {\n        get: function() {\n          if(this.dataindex.symbols === '是') {return true; }\n          else {return false; }\n        },\n        set: function(v) {\n          if(v) {this.dataindex.symbols = '是'; }\n          else {this.dataindex.symbols = '否'; }\n        }\n      },\n      dataFormat() {\n        var x = this.dataFormatMap[this.dataindex.type];\n        if(x&&x.length == 3) {\n          x += this.dataindex.length;\n        }\n        return x;\n      }\n    }\n  });\n})(window);"]}